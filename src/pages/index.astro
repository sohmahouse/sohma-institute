---
import PortalLayout from '../layouts/PortalLayout.astro'

---

<PortalLayout
  title="Institute of Traditional Medicines"
  description="An Australian training institution advancing traditional pharmacological systems through clinical education, a practitioner network, and research programs across five divisions."
>
  <article class="home-page">

    <!-- HERO -->
    <header class="home-hero">
      <div class="hero-inner">
        <div class="section-label">Sohma Institute of Traditional Medicines</div>
        <h1 class="hero-title">Training practitioners for the medicine <span class="hero-accent">that already exists.</span></h1>
        <p class="hero-lead">An Australian training institution advancing traditional pharmacological systems as sophisticated therapeutic architectures — not alternatives to modern medicine, but its predecessors. Five clinical divisions. A credential ladder from foundation to fellowship. A practitioner network that gets smarter because you participate.</p>
        <div class="hero-cta-row">
          <a href="/education" class="hero-cta-primary">Explore education programs &rarr;</a>
          <a href="/network" class="hero-cta-secondary">Enter The Field</a>
        </div>
      </div>
    </header>


    <!-- THREE PILLARS -->
    <section class="pillars-section">
      <span class="pillars-eyebrow">What We Do</span>
      <h2 class="section-heading">Three interconnected systems</h2>
      <div class="pillars-grid">
        <a href="/education" class="pillar-card">
          <h3>Education</h3>
          <p>Four credential tiers from foundation to fellowship. Case-based clinical mentorship, not lecture-hall reproduction. Every qualification is built on supervised practice within real patient populations.</p>
          <span class="pillar-link">Explore programs &rarr;</span>
        </a>
        <a href="/network" class="pillar-card">
          <h3>The Field</h3>
          <p>A distributed clinical intelligence network. Credentialed practitioners running shared protocols, contributing outcome data, and conferencing on complex cases across divisional boundaries.</p>
          <span class="pillar-link">Enter The Field &rarr;</span>
        </a>
        <a href="/research" class="pillar-card">
          <h3>Research</h3>
          <p>Six research programs developing methodologies appropriate to the complexity of traditional medicine interventions. Whole-systems design, adaptive protocols, and practice-based evidence networks.</p>
          <span class="pillar-link">View programs &rarr;</span>
        </a>
      </div>
    </section>


    <!-- POSITIONING STATEMENT -->
    <section class="position-band">
      <div class="position-inner">
        <span class="position-eyebrow">Foundational Position</span>
        <h2 class="position-heading">The Post-Reductionist Correction</h2>
        <p class="position-statement">The dominant framing positions traditional medicines as "complementary" or "alternative." The Institute rejects this. Ayurveda, TCM, Unani, Kampo, and Indigenous pharmacopoeia are sophisticated therapeutic architectures that anticipated network pharmacology, systems biology, and precision therapeutics by centuries. These are not analogies. They are convergent descriptions of the same therapeutic reality.</p>
        <a href="/about" class="position-link">Read our full position &rarr;</a>
      </div>
    </section>


    <!-- DIVISIONS -->
    <section id="divisions" class="divisions-section">
      <div class="divisions-inner">
        <span class="divisions-eyebrow">Academic Divisions</span>
        <h2 class="divisions-heading">Institute Divisions</h2>
        <p class="divisions-intro">Each division operates as a semi-autonomous academic unit with its own research agenda, credentialing pathway, and clinical translation pipeline.</p>

        <div class="divisions-grid">
          <a href="/education" class="division-card" data-accent="terracotta">
            <span class="division-dot"></span>
            <span class="division-num">I</span>
            <h3>Complex Herbal Medicines</h3>
            <p>Multi-constituent botanical therapeutics, phytochemical synergy, traditional pharmacopoeia systems, and clinical herbal prescribing.</p>
          </a>

          <a href="/education" class="division-card" data-accent="warm">
            <span class="division-dot"></span>
            <span class="division-num">II</span>
            <h3>Emergent &amp; Entheogenic Modalities</h3>
            <p>Cannabis medicine, psilocybin-assisted therapy, psychedelic integration, and novel consciousness-based therapeutic frameworks.</p>
          </a>

          <a href="/education" class="division-card" data-accent="blue">
            <span class="division-dot"></span>
            <span class="division-num">III</span>
            <h3>Systems &amp; Functional Medicine</h3>
            <p>Systems biology approaches to chronic complex illness, functional diagnostics, metabolomic and genomic interpretation.</p>
          </a>

          <a href="/education" class="division-card" data-accent="teal">
            <span class="division-dot"></span>
            <span class="division-num">IV</span>
            <h3>Environmental &amp; Nutritional Medicine</h3>
            <p>Toxicant exposure assessment, environmental determinants, clinical nutrition, microbiome therapeutics.</p>
          </a>

          <a href="/education" class="division-card" data-accent="purple">
            <span class="division-dot"></span>
            <span class="division-num">V</span>
            <h3>Lifestyle &amp; Relational Medicine</h3>
            <p>Somatic therapy, contemplative practice, movement medicine, sleep architecture, and relational health.</p>
          </a>
        </div>
      </div>
    </section>


    <!-- ENTRY PATHWAY -->
    <section class="pathway-section">
      <span class="pathway-eyebrow">Your Entry Point</span>
      <h2 class="section-heading">Four tiers. One credential ladder.</h2>
      <p class="section-intro">Every practitioner enters through the Foundation Certificate. From there, the ladder builds — each tier expanding your clinical autonomy, supervisory responsibilities, and depth of access to the Institute's protocol library.</p>
      <div class="pathway-grid">
        <div class="pathway-tiers">
          <a href="/education/foundation-certificate" class="pathway-tier">
            <span class="pathway-num">1</span>
            <div class="pathway-tier-content">
              <h3>Foundation Certificate</h3>
              <span class="pathway-meta">12 weeks &middot; Online + Clinical Intensive</span>
            </div>
          </a>
          <a href="/education/advanced-diploma" class="pathway-tier">
            <span class="pathway-num">2</span>
            <div class="pathway-tier-content">
              <h3>Advanced Diploma</h3>
              <span class="pathway-meta">12 months &middot; Hybrid Clinical Mentorship</span>
            </div>
          </a>
          <a href="/education/graduate-diploma" class="pathway-tier">
            <span class="pathway-num">3</span>
            <div class="pathway-tier-content">
              <h3>Graduate Diploma</h3>
              <span class="pathway-meta">18 months &middot; Research + Clinical Integration</span>
            </div>
          </a>
          <a href="/education/fellowship" class="pathway-tier">
            <span class="pathway-num">4</span>
            <div class="pathway-tier-content">
              <h3>Fellowship</h3>
              <span class="pathway-meta">2 years &middot; Clinical Leadership + Research</span>
            </div>
          </a>
        </div>
        <div class="pathway-cta-col">
          <p>Your credential determines your tier in The Field — the practitioner network. The network gets stronger with every practitioner who joins.</p>
          <a href="/education" class="pathway-btn">View all programs &rarr;</a>
        </div>
      </div>
    </section>


    <!-- CTA -->
    <section class="cta-section">
      <div class="cta-inner">
        <div class="cta-primary-block">
          <span class="cta-eyebrow">Get Started</span>
          <h2>The Foundation Certificate is your entry point.</h2>
          <p>12 weeks. One division. The beginning of a credential that changes how you practise.</p>
          <a href="/contact" class="cta-primary-btn">Express interest &rarr;</a>
        </div>
        <div class="cta-secondary-block">
          <a href="/education" class="cta-alt">
            <span class="cta-alt-label">Want details first?</span>
            <span class="cta-alt-action">View education programs &rarr;</span>
          </a>
          <a href="/network" class="cta-alt">
            <span class="cta-alt-label">Already credentialed?</span>
            <span class="cta-alt-action">Enter The Field &rarr;</span>
          </a>
          <a href="/whitepapers" class="cta-alt">
            <span class="cta-alt-label">Read the evidence</span>
            <span class="cta-alt-action">Browse whitepapers &rarr;</span>
          </a>
        </div>
      </div>
    </section>

  </article>
</PortalLayout>

<style>
  /* ═══════════ BASE ═══════════ */
  .home-page {
    font-family: 'Manrope', sans-serif;
    color: var(--text-heading);
    padding: 0;
  }
  .home-page p { line-height: 1.8; margin: 0 0 1rem; }
  .home-page p:last-child { margin-bottom: 0; }
  .home-page h2, .home-page h3 { margin: 0; }

  :global(.reading-progress) { display: none !important; }

  .section-label {
    display: flex;
    align-items: center;
    gap: 12px;
    font-family: 'Manrope', sans-serif;
    font-size: 0.6875rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.14em;
    color: var(--accent-dark);
    margin-bottom: 1.25rem;
  }
  .section-label::after {
    content: '';
    flex: 1;
    height: 1px;
    background: var(--accent-line);
  }

  .section-heading {
    font-family: 'Cormorant Garamond', serif;
    font-size: 2.5rem;
    font-weight: 400;
    color: var(--text-heading);
    line-height: 1.2;
    margin-bottom: 0.75rem;
    letter-spacing: -0.01em;
  }
  .section-intro {
    font-size: 0.9375rem;
    color: var(--text-secondary);
    line-height: 1.75;
    max-width: 640px;
    margin-bottom: 2.5rem;
  }


  /* ═══════════ HERO ═══════════ */
  .home-hero {
    position: relative;
    max-width: none;
    margin: 0 -40px;
    padding: 0;
    background: var(--bg-hero);
    overflow: visible;
  }

  .hero-inner {
    position: relative;
    z-index: 1;
    padding: 96px calc(2rem + 40px) 64px calc(1rem + 40px);
    border-bottom: 1px solid var(--border-light);
  }

  .hero-title {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(2.25rem, 4vw, 3.5rem);
    font-weight: 500;
    line-height: 1.1;
    letter-spacing: -0.01em;
    color: var(--text-heading);
    max-width: 800px;
    margin: 0 0 24px;
  }

  .hero-accent {
    font-style: italic;
    color: var(--accent-dark);
  }

  .hero-lead {
    font-size: 1.0625rem;
    color: var(--text-secondary);
    line-height: 1.65;
    max-width: 640px;
    padding-left: 1.5rem;
    margin-bottom: 0;
  }

  .hero-cta-row {
    margin-top: 3rem;
    display: flex;
    align-items: center;
    gap: 2rem;
    padding-left: 1.5rem;
  }

  .hero-cta-primary {
    display: inline-block;
    padding: 12px 28px;
    font-family: 'Manrope', sans-serif;
    font-size: 0.8125rem;
    font-weight: 600;
    letter-spacing: 0.03em;
    color: #fff;
    background: var(--accent-dark);
    border-radius: 4px;
    text-decoration: none;
    transition: background 0.2s, transform 0.15s;
  }

  .hero-cta-primary:hover {
    background: var(--accent-darker-hover);
    transform: translateY(-1px);
  }

  .hero-cta-secondary {
    font-family: 'Manrope', sans-serif;
    font-size: 0.8125rem;
    font-weight: 600;
    letter-spacing: 0.02em;
    color: var(--text-tertiary);
    text-decoration: none;
    transition: color 0.15s;
  }

  .hero-cta-secondary:hover {
    color: var(--accent-dark);
  }


  /* ═══════════ THREE PILLARS ═══════════ */
  .pillars-section {
    padding: 5rem 0 4rem;
    border-bottom: 1px solid var(--border-light);
  }

  .pillars-eyebrow {
    display: block;
    font-family: 'Manrope', sans-serif;
    font-size: 0.625rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.14em;
    color: var(--accent-dark);
    opacity: 0.7;
    margin-bottom: 0.75rem;
  }

  .pillars-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 0 2.5rem;
    margin-top: 2.5rem;
  }

  .pillar-card {
    display: block;
    padding: 1.75rem 0 0;
    border-top: 1px solid var(--border-light);
    text-decoration: none;
    transition: border-color 0.2s;
  }

  .pillar-card:hover {
    border-color: var(--accent-dark);
  }

  .pillar-card h3 {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.35rem;
    font-weight: 500;
    color: var(--text-heading);
    margin-bottom: 0.875rem;
  }

  .pillar-card p {
    font-size: 0.8125rem;
    color: var(--text-body-60);
    line-height: 1.75;
    margin-bottom: 0;
  }

  .pillar-link {
    display: inline-block;
    margin-top: 1.25rem;
    font-family: 'Manrope', sans-serif;
    font-size: 0.75rem;
    font-weight: 600;
    letter-spacing: 0.02em;
    color: var(--accent-dark);
    opacity: 0;
    transition: opacity 0.2s;
  }

  .pillar-card:hover .pillar-link {
    opacity: 1;
  }


  /* ═══════════ POSITIONING STATEMENT ═══════════ */
  .position-band {
    margin: 0 -40px;
    padding: 5rem 40px;
    background: var(--bg-surface);
    border-top: 1px solid var(--border-light);
    border-bottom: 1px solid var(--border-light);
    text-align: center;
  }

  .position-inner {
    max-width: 640px;
    margin: 0 auto;
  }

  .position-eyebrow {
    display: block;
    font-family: 'Manrope', sans-serif;
    font-size: 0.625rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.14em;
    color: var(--accent-dark);
    opacity: 0.7;
    margin-bottom: 0.75rem;
  }

  .home-page .position-heading {
    font-family: 'Cormorant Garamond', serif;
    font-size: 2.5rem;
    font-weight: 400;
    color: var(--text-heading);
    letter-spacing: -0.01em;
    margin: 0 0 1.5rem;
  }

  .position-statement {
    font-size: 1.0625rem;
    color: var(--text-secondary);
    line-height: 1.85;
  }

  .position-link {
    display: inline-block;
    margin-top: 1.5rem;
    font-family: 'Manrope', sans-serif;
    font-size: 0.75rem;
    font-weight: 600;
    letter-spacing: 0.02em;
    color: var(--accent-dark);
    text-decoration: none;
    transition: color 0.15s;
  }

  .position-link:hover {
    color: var(--accent-darker-hover);
  }


  /* ═══════════ DIVISIONS ═══════════ */
  .divisions-section {
    padding: 5rem 0;
    border-bottom: 1px solid var(--border-light);
  }

  .divisions-inner { max-width: 100%; }

  .divisions-eyebrow {
    display: block;
    font-family: 'Manrope', sans-serif;
    font-size: 0.625rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.14em;
    color: var(--accent-dark);
    opacity: 0.7;
    margin-bottom: 0.75rem;
  }

  .home-page .divisions-heading {
    font-family: 'Cormorant Garamond', serif;
    font-size: 2.5rem;
    font-weight: 400;
    color: var(--text-heading);
    letter-spacing: -0.01em;
    margin: 0 0 1rem;
  }

  .divisions-intro {
    font-size: 0.9375rem;
    color: var(--text-secondary);
    line-height: 1.75;
    max-width: 620px;
    margin-bottom: 2.5rem;
  }

  .divisions-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 0 2rem;
  }

  .division-card {
    display: block;
    padding: 1.75rem 0;
    background: none;
    border: none;
    border-top: 1px solid var(--border-light);
    border-radius: 0;
    text-decoration: none;
    transition: opacity 0.2s;
  }

  .division-card:hover {
    opacity: 0.8;
  }

  .division-dot {
    display: block;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    margin-bottom: 1rem;
  }

  [data-accent="terracotta"] .division-dot { background: var(--accent-dark); }
  [data-accent="warm"] .division-dot { background: var(--chart-warm); }
  [data-accent="blue"] .division-dot { background: var(--chart-blue); }
  [data-accent="teal"] .division-dot { background: var(--chart-teal); }
  [data-accent="purple"] .division-dot { background: var(--chart-purple); }

  .division-num {
    display: block;
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.5rem;
    color: var(--text-heading);
    opacity: 0.35;
    line-height: 1;
    margin-bottom: 0.75rem;
  }

  .division-card h3 {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.1rem;
    font-weight: 500;
    color: var(--text-heading);
    line-height: 1.3;
    margin-bottom: 0.75rem;
  }

  .division-card p {
    font-size: 0.75rem;
    color: var(--text-body-60);
    line-height: 1.65;
    margin-bottom: 0;
  }


  /* ═══════════ ENTRY PATHWAY ═══════════ */
  .pathway-section {
    padding: 7rem 0 5rem;
    border-bottom: 1px solid var(--border-light);
  }

  .pathway-eyebrow {
    display: block;
    font-family: 'Manrope', sans-serif;
    font-size: 0.625rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.14em;
    color: var(--accent-dark);
    opacity: 0.7;
    margin-bottom: 0.75rem;
  }

  .pathway-grid {
    display: grid;
    grid-template-columns: 1fr 320px;
    gap: 4rem;
    margin-top: 2.5rem;
  }

  .pathway-tiers {
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  .pathway-tier {
    display: flex;
    align-items: center;
    gap: 1.25rem;
    padding: 1.25rem 0;
    border-top: 1px solid var(--border-light);
    text-decoration: none;
    transition: border-color 0.2s;
  }

  .pathway-tier:hover {
    border-color: var(--accent-dark);
  }

  .pathway-num {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    border: 1px solid var(--border-light);
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--text-tertiary);
    flex-shrink: 0;
    transition: border-color 0.2s, color 0.2s;
  }

  .pathway-tier:hover .pathway-num,
  .pathway-tier.active .pathway-num {
    border-color: var(--accent-dark);
    color: var(--accent-dark);
  }

  .pathway-tier.active {
    border-color: var(--accent-dark);
  }

  .pathway-tier-content h3 {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.25rem;
    font-weight: 500;
    color: var(--text-heading);
    margin-bottom: 0.25rem;
  }

  .pathway-meta {
    font-family: 'Manrope', sans-serif;
    font-size: 0.6875rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: var(--text-tertiary);
  }

  .pathway-cta-col {
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  .pathway-cta-col p {
    font-size: 0.9375rem;
    color: var(--text-secondary);
    line-height: 1.75;
    margin-bottom: 1.5rem;
  }

  .pathway-btn {
    display: inline-block;
    padding: 12px 28px;
    font-family: 'Manrope', sans-serif;
    font-size: 0.8125rem;
    font-weight: 600;
    letter-spacing: 0.03em;
    color: #fff;
    background: var(--accent-dark);
    border-radius: 4px;
    text-decoration: none;
    transition: background 0.2s, transform 0.15s;
    align-self: flex-start;
  }

  .pathway-btn:hover {
    background: var(--accent-darker-hover);
    transform: translateY(-1px);
  }


  /* ═══════════ CTA ═══════════ */
  .cta-section {
    margin: 0 -40px;
    padding: 0;
    background: #141210;
    border-bottom: none;
  }

  .cta-inner {
    max-width: 640px;
    margin: 0 auto;
    padding: 6rem 2rem;
    text-align: center;
  }

  .cta-eyebrow {
    display: block;
    font-family: 'Manrope', sans-serif;
    font-size: 0.625rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.14em;
    color: rgba(196, 110, 66, 0.7);
    margin-bottom: 1rem;
  }

  .cta-primary-block h2 {
    font-family: 'Cormorant Garamond', serif;
    font-size: 3rem;
    font-weight: 400;
    color: #e8dfd0;
    letter-spacing: -0.01em;
    margin: 0 0 1.25rem;
  }

  .cta-primary-block p {
    font-size: 1rem;
    color: rgba(208, 200, 188, 0.55);
    line-height: 1.7;
    max-width: 440px;
    margin: 0 auto 2.5rem;
  }

  .cta-primary-btn {
    display: inline-block;
    padding: 14px 40px;
    font-family: 'Manrope', sans-serif;
    font-size: 0.8125rem;
    font-weight: 600;
    letter-spacing: 0.03em;
    color: #141210;
    background: var(--accent-dark);
    border: none;
    border-radius: 4px;
    text-decoration: none;
    transition: background 0.2s, transform 0.15s;
  }

  .cta-primary-btn:hover {
    background: #d4773a;
    transform: translateY(-1px);
  }

  .cta-secondary-block {
    display: flex;
    justify-content: center;
    gap: 3rem;
    margin-top: 3rem;
    padding-top: 2.5rem;
    border-top: 1px solid rgba(255, 255, 255, 0.06);
  }

  .cta-alt {
    text-decoration: none;
    text-align: center;
  }

  .cta-alt-label {
    display: block;
    font-family: 'Manrope', sans-serif;
    font-size: 0.6875rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: rgba(208, 200, 188, 0.35);
    margin-bottom: 0.375rem;
  }

  .cta-alt-action {
    display: block;
    font-size: 0.8125rem;
    color: rgba(208, 200, 188, 0.6);
    transition: color 0.2s;
  }

  .cta-alt:hover .cta-alt-action {
    color: #e8dfd0;
  }


  /* ═══════════ RESPONSIVE ═══════════ */
  @media (max-width: 1024px) {
    .home-hero { margin: 0 -20px; }
    .hero-inner { padding: 64px calc(1.5rem + 20px) 48px calc(1rem + 20px); }
    .position-band { margin: 0 -20px; padding: 5rem 20px; }
    .divisions-grid { grid-template-columns: repeat(3, 1fr); }
    .pathway-grid { grid-template-columns: 1fr; }
    .cta-section { margin: 0 -20px; }
  }

  @media (max-width: 768px) {
    .hero-inner { padding: 48px 1.25rem 36px; }
    .hero-title { font-size: 2.25rem; }
    .hero-lead { padding-left: 0; }
    .hero-cta-row { padding-left: 0; flex-direction: column; gap: 1rem; align-items: flex-start; }
    .pillars-grid { grid-template-columns: 1fr; }
    .home-page .position-heading { font-size: 2rem; }
    .divisions-grid { grid-template-columns: 1fr 1fr; }
    .pathway-grid { grid-template-columns: 1fr; gap: 2rem; }
    .cta-inner { padding: 4rem 1.25rem; }
    .cta-primary-block h2 { font-size: 2.25rem; }
    .cta-secondary-block { flex-direction: column; gap: 1.5rem; }
  }

  @media (max-width: 480px) {
    .divisions-grid { grid-template-columns: 1fr; }
    .hero-title { font-size: 2rem; }
  }
</style>

<script>
  function initHomeReveal() {
    const targets = document.querySelectorAll('.pillar-card, .pathway-tier')
    if (!targets.length) return

    targets.forEach(el => {
      const htmlEl = el as HTMLElement
      htmlEl.style.opacity = '0'
      htmlEl.style.transform = 'translateY(12px)'
      htmlEl.style.transition = 'opacity 0.5s ease, transform 0.5s ease'
    })

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const el = entry.target as HTMLElement
          el.style.opacity = '1'
          el.style.transform = 'translateY(0)'
          observer.unobserve(el)
        }
      })
    }, { threshold: 0.15 })

    targets.forEach(el => observer.observe(el))
  }

  function initPathwayActive() {
    const tiers = document.querySelectorAll('.pathway-tier')
    if (!tiers.length) return

    function updateActive() {
      const midY = window.innerHeight / 2
      let closest: Element | null = null
      let closestDist = Infinity

      tiers.forEach(tier => {
        const rect = tier.getBoundingClientRect()
        const center = rect.top + rect.height / 2
        const dist = Math.abs(center - midY)
        if (dist < closestDist && rect.top < window.innerHeight && rect.bottom > 0) {
          closestDist = dist
          closest = tier
        }
      })

      tiers.forEach(tier => {
        if (tier === closest && closestDist < 200) {
          tier.classList.add('active')
        } else {
          tier.classList.remove('active')
        }
      })
    }

    window.addEventListener('scroll', updateActive, { passive: true })
    updateActive()
  }

  document.addEventListener('DOMContentLoaded', () => { initHomeReveal(); initPathwayActive(); })
  document.addEventListener('astro:page-load', () => { initHomeReveal(); initPathwayActive(); })
</script>
